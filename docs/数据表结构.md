# 企业碳计量数字化平台数据表结构

## 1. 用户表 (users)

| 字段 | 注释 | 类型 | 空否 |
|------|------|------|------|
| id | 用户ID | BIGINT | 否 |
| email | 邮箱 | VARCHAR(255) | 否 |
| password_hash | 密码哈希值 | VARCHAR(255) | 否 |
| name | 用户姓名 | VARCHAR(100) | 否 |
| phone | 电话号码 | VARCHAR(20) | 是 |
| status | 用户状态 | ENUM('ACTIVE', 'INACTIVE', 'LOCKED') | 否 |
| created_at | 创建时间 | TIMESTAMP | 否 |
| updated_at | 更新时间 | TIMESTAMP | 否 |
| last_login_at | 最后登录时间 | TIMESTAMP | 是 |

## 2. 组织表 (organizations)

| 字段 | 注释 | 类型 | 空否 |
|------|------|------|------|
| id | 组织ID | BIGINT | 否 |
| name | 组织名称 | VARCHAR(255) | 否 |
| code | 组织编码 | VARCHAR(50) | 否 |
| industry | 行业分类 | VARCHAR(100) | 是 |
| address | 地址 | TEXT | 是 |
| contact_person | 联系人 | VARCHAR(100) | 是 |
| contact_phone | 联系电话 | VARCHAR(20) | 是 |
| status | 组织状态 | ENUM('ACTIVE', 'INACTIVE') | 否 |
| created_at | 创建时间 | TIMESTAMP | 否 |
| updated_at | 更新时间 | TIMESTAMP | 否 |

## 3. 成员关系表 (memberships)

| 字段 | 注释 | 类型 | 空否 |
|------|------|------|------|
| id | 成员关系ID | BIGINT | 否 |
| user_id | 用户ID | BIGINT | 否 |
| organization_id | 组织ID | BIGINT | 否 |
| role | 角色 | ENUM('ADMIN', 'MANAGER', 'MEMBER', 'READONLY') | 否 |
| status | 成员状态 | ENUM('ACTIVE', 'INACTIVE') | 否 |
| joined_at | 加入时间 | TIMESTAMP | 否 |
| left_at | 离开时间 | TIMESTAMP | 是 |

## 4. 设施表 (facilities)

| 字段 | 注释 | 类型 | 空否 |
|------|------|------|------|
| id | 设施ID | BIGINT | 否 |
| organization_id | 组织ID | BIGINT | 否 |
| name | 设施名称 | VARCHAR(255) | 否 |
| type | 设施类型 | ENUM('OFFICE', 'FACTORY', 'WAREHOUSE', 'OTHER') | 否 |
| location | 位置 | VARCHAR(255) | 是 |
| area | 面积(平方米) | DECIMAL(15,2) | 是 |
| description | 描述 | TEXT | 是 |
| status | 设施状态 | ENUM('ACTIVE', 'INACTIVE') | 否 |
| created_at | 创建时间 | TIMESTAMP | 否 |
| updated_at | 更新时间 | TIMESTAMP | 否 |

## 5. 项目表 (projects)

| 字段 | 注释 | 类型 | 空否 |
|------|------|------|------|
| id | 项目ID | BIGINT | 否 |
| organization_id | 组织ID | BIGINT | 否 |
| name | 项目名称 | VARCHAR(255) | 否 |
| code | 项目编码 | VARCHAR(50) | 否 |
| description | 项目描述 | TEXT | 是 |
| start_date | 开始日期 | DATE | 是 |
| end_date | 结束日期 | DATE | 是 |
| status | 项目状态 | ENUM('PLANNING', 'ACTIVE', 'COMPLETED', 'CANCELLED') | 否 |
| created_at | 创建时间 | TIMESTAMP | 否 |
| updated_at | 更新时间 | TIMESTAMP | 否 |

## 6. 活动记录表 (activity_records)

| 字段 | 注释 | 类型 | 空否 |
|------|------|------|------|
| id | 活动记录ID | BIGINT | 否 |
| organization_id | 组织ID | BIGINT | 否 |
| facility_id | 设施ID | BIGINT | 是 |
| project_id | 项目ID | BIGINT | 是 |
| scope | 排放范围 | ENUM('SCOPE_1', 'SCOPE_2', 'SCOPE_3') | 否 |
| category | 活动类别 | VARCHAR(100) | 否 |
| activity_type | 活动类型 | VARCHAR(100) | 否 |
| amount | 活动数据量 | DECIMAL(20,6) | 否 |
| unit | 单位 | VARCHAR(50) | 否 |
| period_start | 期间开始时间 | DATE | 否 |
| period_end | 期间结束时间 | DATE | 否 |
| description | 描述 | TEXT | 是 |
| reference | 引用编号 | VARCHAR(255) | 是 |
| data_quality | 数据质量 | ENUM('MEASURED', 'CALCULATED', 'ESTIMATED') | 否 |
| uncertainty | 不确定性(%) | DECIMAL(5,2) | 是 |
| is_verified | 是否已验证 | BOOLEAN | 否 |
| verified_by | 验证人ID | BIGINT | 是 |
| verified_at | 验证时间 | TIMESTAMP | 是 |
| metadata | 元数据(JSON) | JSON | 是 |
| created_at | 创建时间 | TIMESTAMP | 否 |
| updated_at | 更新时间 | TIMESTAMP | 否 |

## 7. 排放因子表 (emission_factors)

| 字段 | 注释 | 类型 | 空否 |
|------|------|------|------|
| id | 排放因子ID | BIGINT | 否 |
| organization_id | 组织ID | BIGINT | 是 |
| activity_type | 活动类型 | VARCHAR(100) | 否 |
| region | 地区 | VARCHAR(100) | 是 |
| year | 年份 | INT | 是 |
| factor_value | 因子值 | DECIMAL(20,10) | 否 |
| factor_unit | 因子单位 | VARCHAR(100) | 否 |
| gwp | 全球变暖潜值 | DECIMAL(10,4) | 是 |
| source | 来源 | ENUM('IPCC', 'DEFRA', 'EPA', 'CUSTOM', 'OTHER') | 否 |
| reference | 引用文献 | TEXT | 是 |
| priority | 优先级 | INT | 否 |
| description | 描述 | TEXT | 是 |
| assumptions | 假设条件(JSON) | JSON | 是 |
| created_at | 创建时间 | TIMESTAMP | 否 |
| updated_at | 更新时间 | TIMESTAMP | 否 |

## 8. 计算结果表 (calculation_results)

| 字段 | 注释 | 类型 | 空否 |
|------|------|------|------|
| id | 计算结果ID | BIGINT | 否 |
| activity_record_id | 活动记录ID | BIGINT | 否 |
| organization_id | 组织ID | BIGINT | 否 |
| emission_factor_id | 排放因子ID | BIGINT | 否 |
| t_co2e | 二氧化碳当量(吨) | DECIMAL(20,10) | 否 |
| breakdown | 计算明细(JSON) | JSON | 是 |
| method | 计算方法 | VARCHAR(255) | 否 |
| data_quality | 数据质量 | ENUM('MEASURED', 'CALCULATED', 'ESTIMATED') | 否 |
| calculated_at | 计算时间 | TIMESTAMP | 否 |
| calculated_by | 计算人ID | BIGINT | 是 |

## 9. 报表表 (reports)

| 字段 | 注释 | 类型 | 空否 |
|------|------|------|------|
| id | 报表ID | BIGINT | 否 |
| organization_id | 组织ID | BIGINT | 否 |
| name | 报表名称 | VARCHAR(255) | 否 |
| type | 报表类型 | VARCHAR(100) | 否 |
| period_start | 期间开始时间 | DATE | 否 |
| period_end | 期间结束时间 | DATE | 否 |
| filters | 过滤条件(JSON) | JSON | 是 |
| data | 报表数据(JSON) | JSON | 是 |
| format | 格式 | ENUM('PDF', 'EXCEL', 'CSV', 'JSON') | 否 |
| status | 报表状态 | ENUM('GENERATING', 'COMPLETED', 'FAILED') | 否 |
| generated_at | 生成时间 | TIMESTAMP | 是 |
| generated_by | 生成人ID | BIGINT | 是 |
| file_path | 文件路径 | VARCHAR(500) | 是 |

## 10. 审计日志表 (audit_logs)

| 字段 | 注释 | 类型 | 空否 |
|------|------|------|------|
| id | 日志ID | BIGINT | 否 |
| user_id | 用户ID | BIGINT | 是 |
| organization_id | 组织ID | BIGINT | 是 |
| action | 操作类型 | VARCHAR(100) | 否 |
| resource_type | 资源类型 | VARCHAR(100) | 否 |
| resource_id | 资源ID | BIGINT | 是 |
| description | 描述 | TEXT | 是 |
| ip_address | IP地址 | VARCHAR(45) | 是 |
| user_agent | 用户代理 | TEXT | 是 |
| created_at | 创建时间 | TIMESTAMP | 否 |